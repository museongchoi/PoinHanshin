<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}">
<head>
    <meta charset="UTF-8">
    <title>임보자상세페이지</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.7.0.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
</head>
<style>
    button {
        float : right;
    }
    @media (min-width: 768px) {
      .page {
        width: 600px;
      }
    }

    @media (min-width: 992px) {
      .page {
        width: 940px;
      }
    }

    @media (min-width: 1200px) {
      .page {
        width: 940px;
      }
    }
   html,body{
       width: 100%;
       height: 100%;
   }
  .page {
        margin: 0 auto;
        height: 100%;
        padding: 50px;
        border-left: 1px solid black;
        border-right: 1px solid black;
        border-bottom-width: 2px;
    }

</style>

<body layout:fragment="content">
<script th:if="${msg} == 'SUCCESS_UPDATE'">alert("게시글을 수정했습니다.")</script>
<script th:if="${msg} == 'FAIL_UPDATE'">alert("게시글을 수정하지 못했습니다.")</script>
<script th:if="${msg} == 'FAIL_REMOVE'">alert("게시글을 삭제하지 못했습니다.")</script>
<script th:if="${msg} == 'SUCCESS_INSERT'">alert("게시글을 등록했습니다.")</script>
<div class="page">

    <form id="form" action="" method="post">
        <div class="col-5 p-3">
            <input type="hidden" name="protectboard_userno" th:value="${protectboard.protectboard_userno}">
            <input type="hidden" name="protectboardno" th:value="${protectboard.protectboardno}">
            Content<textarea name="protectboard_content" id="inputContent" th:text="${protectboard.protectboard_content}" readonly="readonly"></textarea>
            imgPath<input type="File" name="protectboard_imagepath" th:value="${protectboard.protectboard_imagepath}">
            <input type="hidden" name="protectboard_ani_category" th:value="${protectboard.protectboard_ani_category}">
            reg_Date<input type="date" name="protectboard_reg_date" th:value="${protectboard.protectboard_reg_date}" id="reg_date" readonly="readonly">
            <input type="hidden" name="protectstatus" th:value="${protectboard.protectstatus}">
            deadLine<input type="date" name="deadline" th:value="${protectboard.deadline}"id="deadline" readonly="readonly">
            breeds<input type="text" name="breeds" th:value="${protectboard.breeds}" id="breeds" readonly="readonly">
        </div>
        <div class="col-5 p-3" >
            <span th:if="${WriterCheck} == 'OK'">
                <button type="button" class="btn btn-secondary" id="modifyBtn">수정</button>
                <button type="button" class="btn btn-danger" id="removeBtn">삭제</button>
            </span>
            <button type="button" class="btn btn-secondary"
                    th:onclick="|location.href='@{/protectboard/list(page = ${page} , pageSize = ${pageSize} )}'|">목록
            </button>
        </div>
    </form>
</div>
<script>
    $("#modifyBtn").on("click",function(){
        let form = $('#form');
        let readonly = $("#inputContent").attr("readonly");

        if(readonly != undefined){
            $("#modifyBtn").html("등록");
            $("#inputContent").attr("readonly",false);
            $("#breeds").attr("readonly",false);
            $("#reg_date").attr("readonly",false);
            $("#deadline").attr("readonly",false);
            return;
        }
        if(!confirm("정말로 수정하시겠습니까 ?")) return;
        form.attr("action" , "[[@{/protectboard/modify}]]");
        form.attr("method" , "post");
        form.submit();



    });
    $("#removeBtn").on("click",function(){
        if(!confirm("정말로 삭제하시겠습니까 ?")) return;
        let form = $('#form');
        form.attr("action", "[[@{/protectboard/remove(protectboardno=${protectboard.protectboardno})}]]");
        form.attr("method", "post");
        form.submit();
    });
</script>
</body>
</html>